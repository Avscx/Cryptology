# 消息认证码
- 消息认证码是一种与秘钥相关的单向散列函数。

# HMAC
- HMAC是使用单向散列函数来构造消息认证码的方法，任何高强度的单向散列函数都可以用于HMAC。
## HMAC计算消息认证码的过程：
![如图](https://github.com/jSomething-for-Nothing/cryptography/raw/master/picture/mima/HMAC.png)

# 重放攻击
![如图](https://github.com/jSomething-for-Nothing/cryptography/raw/master/picture/mima/%E9%87%8D%E6%94%BE%E6%94%BB%E5%87%BB.png)

# 预防重放攻击
- 序号 约定每一次都发送的消息赋予一个递增的编号（序号）。
- 时间戳 约定在发送时包含当前的时间，如果收到以前的信息，即使MAC值正确也当做错误信息处理。
- nonce 在通信之前，接受者先向发送者发送一个一次性的随机数，这个随机数称为nonce,发送者在消息中包含这个nonce并计算MAC值，有一每次发送的nonce不同，所以也就不能进行重放攻击。

# 缺陷
- 接受者B接收到来自发送者A的消息之后，不能向第三方证明消息来自发送者A。
- 接受者B收到包含MAC的消息，可以利用发送者A和接受者B的密钥计算出来，从而接受者B能够确定消息来自发送者A，但是发送者A可以否认消息来自它。因为没有人可以证实消息确实来自发送者A。也就是消息认证码无法防止否认。

# 数字签名
- 数字签名的作用就是防止抵赖。数字签名不具有机密性，它生成的密文仅用于代表只有持有该密钥的人才能够生产的信息，所以数字签名可以直接发送消息明文，用于对比。

# 方法
![如图](https://github.com/jSomething-for-Nothing/cryptography/raw/master/picture/%E5%AF%B9%E6%95%A3%E5%88%97%E5%80%BC%E9%AA%8C%E8%AF%81%E7%AD%BE%E5%90%8D.png)

# 通过RSA实现数字签名
> 签名=消息^D mod N（用RSA生成签名）,签名者的私钥(D,N)。
> 由签名求得的信息=签名^E mod N（用RSA验证签名），签名者的公钥是（E,N）。

# 证书
[详情](http://blog.csdn.net/ly131420/article/details/38400583)

# TLS密码技术小结
|密码技术	        | 作用                                           | 
|----------------|：--------------------------------------------：|
|公钥密码	        | 加密预备密码                                    |
|单项散列函数	     |  构成伪随机数生成器                              |
|数字签名	        | 验证服务器和客户端的证书                          |
|伪随机数生成器	  |   生成预备主密码；根据主密码生成密钥；生成初始化向量 |

|密码技术	          |作用                    |
|------------------|：--------------------：|
|对称密码（CBC模式） |确保片段的机密性         |
|消息认证码	       |确保片段的完整性并进行认证 |

# 基于口令的密码（PBE）
## 步骤
- 加密
1.生成KEK。使用伪随机数生成器生成一个成为盐的随机数，把盐和发送者输入的口令一起输入单向散列函数，得到的散列值就是用来加密密钥的密钥（KEK）。
2.生成会话密钥并加密。使用伪随机数生成器生成会话秘钥，会话秘钥用来解密消息。会话秘钥使用KEK加密，并和盐一起保存在安全的地方。会话秘钥加密后KEK会被丢弃。
3.加密消息。用会话密钥对消息进行加密。

- 解密
1.重建KEK。用之前保存的盐和发送者输入的口令一起输入单向散列函数，生成KEK。
2.解密会话密钥。获取之前保存的“用KEK加密的会话秘钥”，用重建的KEK解密，获取会话密钥
3.解密消息。用重建的会话秘钥对加密信息进行解密。 

# 信任网
- 信任网的要点是不依赖认证机构，而是建立人与人之间的信任关系。

# CTF-MISC练习之编码1
- 任务一:B:明文应是admin
- 任务二:D:同一个目录下可以同时存在多个index页面（如index.php和index.html等）
- 任务三:C:把lowercase改为digits运行便得
# CTF-MISC练习之编码2
- 任务一:C:可以通过referer字段的值来进行图片防盗链处理
- 任务二:D:应该是7328489
- 任务三:D
# CTF-MISC练习之编码3
- 任务一:D
- 任务二:B
- 任务三:C
# CTF-MISC练习之编码4
- 任务一:B
- 任务二:C
- 任务三:D
# CTF-MISC练习之编码5
- 任务一:D
- 任务二:B
- 任务三:A
